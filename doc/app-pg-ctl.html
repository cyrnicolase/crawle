<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>pg_ctl</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.6.0 手册"
HREF="index.html"><LINK
REL="UP"
TITLE="PostgreSQL 服务器应用"
HREF="reference-server.html"><LINK
REL="PREVIOUS"
TITLE="pg_controldata"
HREF="app-pgcontroldata.html"><LINK
REL="NEXT"
TITLE="pg_resetxlog"
HREF="app-pgresetxlog.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2017-12-17T04:56:33"></HEAD
><BODY
CLASS="REFENTRY"
>
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/9.6/postgresql/doc/src/sgml/ref/pg_ctl-ref.sgml" target="_blank" 
title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.6.0 手册</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="pg_controldata"
HREF="app-pgcontroldata.html"
ACCESSKEY="P"
>&#19978;&#19968;&#39029;</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="reference-server.html"
ACCESSKEY="U"
>&#19978;&#19968;&#32423;</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="pg_resetxlog"
HREF="app-pgresetxlog.html"
ACCESSKEY="N"
>&#19979;&#19968;&#39029;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="APP-PG-CTL"
></A
><SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
></H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN101728"
></A
><H2
>&#21517;&#31216;</H2
>pg_ctl&nbsp;--&nbsp;初始化、启动、停止或控制一个<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>服务器</DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN101732"
></A
><H2
>&#22823;&#32434;</H2
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>init[db]</TT
>  [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>] [<TT
CLASS="OPTION"
>-o</TT
> <TT
CLASS="REPLACEABLE"
><I
>initdb-options</I
></TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>start</TT
>  [<TT
CLASS="OPTION"
>-w</TT
>] [<TT
CLASS="OPTION"
>-t</TT
> <TT
CLASS="REPLACEABLE"
><I
>seconds</I
></TT
>] [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>] [<TT
CLASS="OPTION"
>-l</TT
> <TT
CLASS="REPLACEABLE"
><I
>filename</I
></TT
>] [<TT
CLASS="OPTION"
>-o</TT
> <TT
CLASS="REPLACEABLE"
><I
>options</I
></TT
>] [<TT
CLASS="OPTION"
>-p</TT
> <TT
CLASS="REPLACEABLE"
><I
>path</I
></TT
>] [<TT
CLASS="OPTION"
>-c</TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>stop</TT
>  [<TT
CLASS="OPTION"
>-W</TT
>] [<TT
CLASS="OPTION"
>-t</TT
> <TT
CLASS="REPLACEABLE"
><I
>seconds</I
></TT
>] [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>] [<TT
CLASS="OPTION"
>-m</TT
>
       <TT
CLASS="OPTION"
>s[mart]</TT
> | <TT
CLASS="OPTION"
>f[ast]</TT
> | <TT
CLASS="OPTION"
>i[mmediate]</TT
> 
   ]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>restart</TT
>  [<TT
CLASS="OPTION"
>-w</TT
>] [<TT
CLASS="OPTION"
>-t</TT
> <TT
CLASS="REPLACEABLE"
><I
>seconds</I
></TT
>] [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>] [<TT
CLASS="OPTION"
>-c</TT
>] [<TT
CLASS="OPTION"
>-m</TT
>
       <TT
CLASS="OPTION"
>s[mart]</TT
> | <TT
CLASS="OPTION"
>f[ast]</TT
> | <TT
CLASS="OPTION"
>i[mmediate]</TT
> 
   ] [<TT
CLASS="OPTION"
>-o</TT
> <TT
CLASS="REPLACEABLE"
><I
>options</I
></TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>reload</TT
>  [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>status</TT
>  [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>promote</TT
>  [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>kill</TT
>   <TT
CLASS="REPLACEABLE"
><I
>signal_name</I
></TT
>   <TT
CLASS="REPLACEABLE"
><I
>process_id</I
></TT
> </P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>register</TT
>  [<TT
CLASS="OPTION"
>-N</TT
> <TT
CLASS="REPLACEABLE"
><I
>servicename</I
></TT
>] [<TT
CLASS="OPTION"
>-U</TT
> <TT
CLASS="REPLACEABLE"
><I
>username</I
></TT
>] [<TT
CLASS="OPTION"
>-P</TT
> <TT
CLASS="REPLACEABLE"
><I
>password</I
></TT
>] [<TT
CLASS="OPTION"
>-D</TT
> <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
>] [<TT
CLASS="OPTION"
>-S</TT
>
       <TT
CLASS="OPTION"
>a[uto]</TT
> | <TT
CLASS="OPTION"
>d[emand]</TT
> 
   ] [<TT
CLASS="OPTION"
>-w</TT
>] [<TT
CLASS="OPTION"
>-t</TT
> <TT
CLASS="REPLACEABLE"
><I
>seconds</I
></TT
>] [<TT
CLASS="OPTION"
>-s</TT
>] [<TT
CLASS="OPTION"
>-o</TT
> <TT
CLASS="REPLACEABLE"
><I
>options</I
></TT
>]</P
><P
><TT
CLASS="COMMAND"
>pg_ctl</TT
>  <TT
CLASS="OPTION"
>unregister</TT
>  [<TT
CLASS="OPTION"
>-N</TT
> <TT
CLASS="REPLACEABLE"
><I
>servicename</I
></TT
>]</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="APP-PG-CTL-DESCRIPTION"
></A
><H2
>描述</H2
><P
>   <SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>是一个用于初始化<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>数据库集簇，启动、停止或重启<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>数据库服务器（<A
HREF="app-postgres.html"
><SPAN
CLASS="APPLICATION"
>postgres</SPAN
></A
>），或者显示一个正在运行服务器的状态的工具。尽管服务器可以被手工启动，<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>包装了重定向日志输出以及正确地从终端和进程组脱离等任务。它也提供了方便的选项用来控制关闭。
  </P
><P
>   <TT
CLASS="OPTION"
>init</TT
>或<TT
CLASS="OPTION"
>initdb</TT
>模式会创建一个新的<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>数据库集簇。一个数据库集簇是一个由单一服务器实例管理的数据库的集合。这个模式调用<TT
CLASS="COMMAND"
>initdb</TT
>命令。详见<A
HREF="app-initdb.html"
>initdb</A
>。
  </P
><P
>   在<TT
CLASS="OPTION"
>start</TT
>模式中，一个新的服务器被启动。该服务器被启动在后台，并且它的标准输出被附加到<TT
CLASS="FILENAME"
>/dev/null</TT
>（或 Windows 上的<TT
CLASS="LITERAL"
>nul</TT
>）。在 Unix 类系统上，默认情况下服务器的标准输出和标准错误被发送到<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>的标准输出（不是标准错误）。<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>的标准输出应该接着被重定向到一个文件或用管道导向另一个进程（例如日志轮转程序<SPAN
CLASS="APPLICATION"
>rotatelogs</SPAN
>）。否则<TT
CLASS="COMMAND"
>postgres</TT
>将把它的输出写到控制终端（从后台）并且将不会离开 shell 的进程组。在 Windows 上，默认情况下服务器的标准输出和标准错误被发送到终端。这些默认行为可以使用<TT
CLASS="OPTION"
>-l</TT
>追加服务器的输出到一个日志文件来改变。我们推荐使用<TT
CLASS="OPTION"
>-l</TT
>或输出重定向。
  </P
><P
>   在<TT
CLASS="OPTION"
>stop</TT
>模式中，运行在指定数据目录中的服务器被关闭。对<TT
CLASS="OPTION"
>-m</TT
>选项可以选择三种不同的关闭方法。<SPAN
CLASS="QUOTE"
>"Smart"</SPAN
>模式等待所有客户端断开连接以及任何在线备份结束。如果该服务器是热备，一旦所有的客户端已经断开连接，恢复和流复制将被终止。<SPAN
CLASS="QUOTE"
>"Fast"</SPAN
>模式（默认）不会等待客户端断开连接并且将终止进行中的在线备份。所有活动事务都被回滚并且客户端被强制断开连接，然后服务器被关闭。<SPAN
CLASS="QUOTE"
>"Immediate"</SPAN
>模式将立刻中止所有服务器进程，而不是做一次干净的关闭。这将导致下一次重启时进行一次崩溃恢复。
  </P
><P
>   <TT
CLASS="OPTION"
>restart</TT
>模式实际上先执行一次停止然后执行一次启动。这允许改变<TT
CLASS="COMMAND"
>postgres</TT
>的命令行选项。如果指定的相对路径是在服务器启动期间在命令行指定的，<TT
CLASS="OPTION"
>restart</TT
>可能会失败。
  </P
><P
>   <TT
CLASS="OPTION"
>reload</TT
>模式简单地向<TT
CLASS="COMMAND"
>postgres</TT
>进程发送一个<SPAN
CLASS="SYSTEMITEM"
>SIGHUP</SPAN
>信号，导致它重新读取它的配置文件（<TT
CLASS="FILENAME"
>postgresql.conf</TT
>、<TT
CLASS="FILENAME"
>pg_hba.conf</TT
>等）。这允许改变配置文件选项而无需一次完整的重启来让改变生效。
  </P
><P
>   <TT
CLASS="OPTION"
>status</TT
>模式检查一个服务器是否运行在指定的数据目录中。如果有一个服务器正在运行，<ACRONYM
CLASS="ACRONYM"
>PID</ACRONYM
>和用来调用它的命令行选项将被显示。如果服务器没有在运行，进程将返回退出状态 3。如果没有指定一个可以访问的数据目录，该进程将返回退出状态 4。
  </P
><P
>   在<TT
CLASS="OPTION"
>promote</TT
>模式中，运行在指定数据目录中的后备服务器被命令退出恢复并且开始读写操作。
  </P
><P
>   <TT
CLASS="OPTION"
>kill</TT
>模式允许你向一个指定进程发送一个消息。这对没有<SPAN
CLASS="APPLICATION"
>kill</SPAN
>命令的<SPAN
CLASS="PRODUCTNAME"
>Microsoft Windows</SPAN
>特别有价值。使用<TT
CLASS="LITERAL"
>--help</TT
>来查看受支持的信号名称列表。
  </P
><P
>   <TT
CLASS="OPTION"
>register</TT
>模式允许你在<SPAN
CLASS="PRODUCTNAME"
>Microsoft Windows</SPAN
>上注册一个系统服务。<TT
CLASS="OPTION"
>-S</TT
>选项允许选择服务启动类型，可以是<SPAN
CLASS="QUOTE"
>"auto"</SPAN
>（随系统自动启动）或<SPAN
CLASS="QUOTE"
>"demand"</SPAN
>（按需启动）。
  </P
><P
>   <TT
CLASS="OPTION"
>unregister</TT
>模式允许你在<SPAN
CLASS="PRODUCTNAME"
>Microsoft Windows</SPAN
>上移除一个系统服务的注册。这会撤销<TT
CLASS="OPTION"
>register</TT
>命令的效果。
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="APP-PG-CTL-OPTIONS"
></A
><H2
>选项</H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="OPTION"
>-c</TT
><BR><TT
CLASS="OPTION"
>--core-file</TT
></DT
><DD
><P
>        在可行的平台上尝试允许服务器崩溃产生核心文件，方法是提升在核心文件上的任何软性资源限制。这通过允许从一个失败的服务器进程中获得一个栈跟踪而有助于调试或诊断问题。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-D <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
></TT
><BR><TT
CLASS="OPTION"
>--pgdata <TT
CLASS="REPLACEABLE"
><I
>datadir</I
></TT
></TT
></DT
><DD
><P
>        指定数据库配置文件的文件系统位置。如果这被忽略，将使用环境变量<TT
CLASS="ENVAR"
>PGDATA</TT
>。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-l <TT
CLASS="REPLACEABLE"
><I
>filename</I
></TT
></TT
><BR><TT
CLASS="OPTION"
>--log <TT
CLASS="REPLACEABLE"
><I
>filename</I
></TT
></TT
></DT
><DD
><P
>        追加服务器日志输出到<TT
CLASS="REPLACEABLE"
><I
>filename</I
></TT
>。如果该文件不存在，它会被创建。<SPAN
CLASS="SYSTEMITEM"
>umask</SPAN
>被设置成 077，这样默认情况下不允许其他用户访问该日志文件。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-m <TT
CLASS="REPLACEABLE"
><I
>mode</I
></TT
></TT
><BR><TT
CLASS="OPTION"
>--mode <TT
CLASS="REPLACEABLE"
><I
>mode</I
></TT
></TT
></DT
><DD
><P
>        指定关闭模式。<TT
CLASS="REPLACEABLE"
><I
>mode</I
></TT
>可以是<TT
CLASS="LITERAL"
>smart</TT
>、<TT
CLASS="LITERAL"
>fast</TT
>或<TT
CLASS="LITERAL"
>immediate</TT
>，或者这三者之一的第一个字母。如果这被忽略，将使用<TT
CLASS="LITERAL"
>fast</TT
>。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-o <TT
CLASS="REPLACEABLE"
><I
>options</I
></TT
></TT
></DT
><DD
><P
>        指定被直接传递给<TT
CLASS="COMMAND"
>postgres</TT
>命令的选项。
        多个选项调用会被追加在一起。
       </P
><P
>        这些选项应该通常被单引号或双引号包围来确保它们被作为一个组传递。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-o <TT
CLASS="REPLACEABLE"
><I
>initdb-options</I
></TT
></TT
></DT
><DD
><P
>        指定要直接传递给<TT
CLASS="COMMAND"
>initdb</TT
>命令的选项。
       </P
><P
>        这些选项应该通常被单引号或双引号包围来确保它们被作为一个组传递。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-p <TT
CLASS="REPLACEABLE"
><I
>path</I
></TT
></TT
></DT
><DD
><P
>        指定<TT
CLASS="FILENAME"
>postgres</TT
>可执行程序的位置。默认情况下，<TT
CLASS="FILENAME"
>postgres</TT
>可执行程序可以从<TT
CLASS="COMMAND"
>pg_ctl</TT
>相同的目录得到，或者如果没有在那里找到，则在硬写的安装目录中获得。除非你正在做一些不同寻常的事并且得到错误说没有找到<TT
CLASS="FILENAME"
>postgres</TT
>可执行程序，这个选项不是必需的。
       </P
><P
>        在<TT
CLASS="LITERAL"
>init</TT
>模式中，这个选项类似于指定了<TT
CLASS="FILENAME"
>initdb</TT
>可执行程序的位置。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-s</TT
><BR><TT
CLASS="OPTION"
>--silent</TT
></DT
><DD
><P
>        只打印错误，不打印信息性的消息。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-t</TT
><BR><TT
CLASS="OPTION"
>--timeout</TT
></DT
><DD
><P
>        等待启动或关闭完成的最大秒数。默认值是环境变量
        <TT
CLASS="ENVAR"
>PGCTLTIMEOUT</TT
>的值，如果该环境变量未设置，则默认值为 60。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-V</TT
><BR><TT
CLASS="OPTION"
>--version</TT
></DT
><DD
><P
>         打印<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>版本并退出。
        </P
></DD
><DT
><TT
CLASS="OPTION"
>-w</TT
></DT
><DD
><P
>        等待启动或关闭完成。等待是关闭的默认选项，但不是启动的默认选项。在等待启动时，<TT
CLASS="COMMAND"
>pg_ctl</TT
>会重复尝试连接到服务器。在等待关闭时，<TT
CLASS="COMMAND"
>pg_ctl</TT
>会等待服务器移除它的<ACRONYM
CLASS="ACRONYM"
>PID</ACRONYM
>文件。这个选项允许在启动时一个<ACRONYM
CLASS="ACRONYM"
>SSL</ACRONYM
>口令的进入。<TT
CLASS="COMMAND"
>pg_ctl</TT
>基于启动或关闭的成功返回一个退出码。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-W</TT
></DT
><DD
><P
>        不等待启动或关闭完成。这是启动和重启模式的默认值。
       </P
></DD
><DT
><TT
CLASS="OPTION"
>-?</TT
><BR><TT
CLASS="OPTION"
>--help</TT
></DT
><DD
><P
>        显示有关<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>命令行参数的帮助并退出。
       </P
></DD
></DL
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="APP-PG-CTL-WINDOWS-OPTIONS"
></A
><H3
>用于 Windows 的选项</H3
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="OPTION"
>-e <TT
CLASS="REPLACEABLE"
><I
>source</I
></TT
></TT
></DT
><DD
><P
>       作为一个 Windows 服务运行时，<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>用来
       在事件日志中记录日志的事件源的名称。默认是<TT
CLASS="LITERAL"
>PostgreSQL</TT
>。
       注意这只控制来自<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>本身的日志，一旦开始，
       服务器将使用<A
HREF="runtime-config-logging.html#GUC-EVENT-SOURCE"
>event_source</A
>中指定的事件源。如果在
       早期的启动阶段服务器失败，它可能也会使用默认的事件源
       <TT
CLASS="LITERAL"
>PostgreSQL</TT
>来记录。
      </P
></DD
><DT
><TT
CLASS="OPTION"
>-N <TT
CLASS="REPLACEABLE"
><I
>servicename</I
></TT
></TT
></DT
><DD
><P
>       要注册的系统服务的名称。这个名称将被用于服务名和显示名。
      </P
></DD
><DT
><TT
CLASS="OPTION"
>-P <TT
CLASS="REPLACEABLE"
><I
>password</I
></TT
></TT
></DT
><DD
><P
>       启动该服务的用户的口令。
      </P
></DD
><DT
><TT
CLASS="OPTION"
>-S <TT
CLASS="REPLACEABLE"
><I
>start-type</I
></TT
></TT
></DT
><DD
><P
>       要注册的系统服务的启动类型。启动类型可以是<TT
CLASS="LITERAL"
>auto</TT
>、<TT
CLASS="LITERAL"
>demand</TT
>或者两者之一的第一个字母。如果这被忽略，会使用<TT
CLASS="LITERAL"
>auto</TT
>。
      </P
></DD
><DT
><TT
CLASS="OPTION"
>-U <TT
CLASS="REPLACEABLE"
><I
>username</I
></TT
></TT
></DT
><DD
><P
>       启动该服务的用户的用户名。对于域用户，使用格式<TT
CLASS="LITERAL"
>DOMAIN\username</TT
>。
      </P
></DD
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN102116"
></A
><H2
>环境</H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="ENVAR"
>PGCTLTIMEOUT</TT
></DT
><DD
><P
>      等待启动或者关闭完成时要等待的默认秒数限制。如果没有设置，
      默认值是 60 秒。
     </P
></DD
><DT
><TT
CLASS="ENVAR"
>PGDATA</TT
></DT
><DD
><P
>      默认的数据目录位置。
     </P
></DD
></DL
></DIV
><P
>   和大部分其他<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>工具相似，<TT
CLASS="COMMAND"
>pg_ctl</TT
>也使用<SPAN
CLASS="APPLICATION"
>libpq</SPAN
>（见<A
HREF="libpq-envars.html"
>第 32.14 &#33410;</A
>）支持的环境变量。更多服务器变量请见<A
HREF="app-postgres.html"
><SPAN
CLASS="APPLICATION"
>postgres</SPAN
></A
>。
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN102135"
></A
><H2
>文件</H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="FILENAME"
>postmaster.pid</TT
></DT
><DD
><P
>      这个文件在数据目录中的存在被用来帮助<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>决定服务器是否正在运行着。
     </P
></DD
><DT
><TT
CLASS="FILENAME"
>postmaster.opts</TT
></DT
><DD
><P
>如果这个文件存在于数据目录中，<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>（处于<TT
CLASS="OPTION"
>restart</TT
>模式中）将把该文件的内容作为选项传递给<SPAN
CLASS="APPLICATION"
>postgres</SPAN
>，除非通过<TT
CLASS="OPTION"
>-o</TT
>选项进行了覆盖。这个文件的内容也会被显示在<TT
CLASS="OPTION"
>status</TT
>模式中。
     </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-APP-PGCTL-2"
></A
><H2
>例子</H2
><DIV
CLASS="REFSECT2"
><A
NAME="R2-APP-PGCTL-3"
></A
><H3
>启动服务器</H3
><P
>    要启动服务器：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl start</KBD
></PRE
><P>
   </P
><P
>    要启动服务器并且等到服务器接受连接：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl -w start</KBD
></PRE
><P>
   </P
><P
>    要使用端口 5433 启动服务器并且运行时不使用<CODE
CLASS="FUNCTION"
>fsync</CODE
>：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl -o "-F -p 5433" start</KBD
></PRE
><P></P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-APP-PGCTL-4"
></A
><H3
>停止服务器</H3
><P
>    要停止服务器，使用：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl stop</KBD
></PRE
><P>
    <TT
CLASS="OPTION"
>-m</TT
>选项允许控制服务器<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>如何</I
></SPAN
>关闭：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl stop -m fast</KBD
></PRE
><P></P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-APP-PGCTL-5"
></A
><H3
>重启服务器</H3
><P
>    重启服务器几乎等价于停止服务器并且再次启动它，不过<TT
CLASS="COMMAND"
>pg_ctl</TT
>会保存并重用被传递给之前的运行实例的命令行选项。要以最简单的形式重启服务器，使用：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl restart</KBD
></PRE
><P>
   </P
><P
>    要重启服务器并等待它关闭和重启：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl -w restart</KBD
></PRE
><P>
   </P
><P
>    要使用端口 5433 重启并在重启时禁用<CODE
CLASS="FUNCTION"
>fsync</CODE
>：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl -o "-F -p 5433" restart</KBD
></PRE
><P></P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-APP-PGCTL-6"
></A
><H3
>显示服务器状态</H3
><P
>    这里是<SPAN
CLASS="APPLICATION"
>pg_ctl</SPAN
>状态输出的例子：
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>pg_ctl status</KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
>pg_ctl: server is running (PID: 13718)
/usr/local/pgsql/bin/postgres "-D" "/usr/local/pgsql/data" "-p" "5433" "-B" "128"</SAMP
></PRE
><P>
    这是在重启模式可能被调用的命令行。
   </P
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN102206"
></A
><H2
>参见</H2
><A
HREF="app-initdb.html"
>initdb</A
>, <A
HREF="app-postgres.html"
><SPAN
CLASS="APPLICATION"
>postgres</SPAN
></A
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="app-pgcontroldata.html"
ACCESSKEY="P"
>&#19978;&#19968;&#39029;</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>&#36215;&#22987;&#39029;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="app-pgresetxlog.html"
ACCESSKEY="N"
>&#19979;&#19968;&#39029;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><SPAN
CLASS="APPLICATION"
>pg_controldata</SPAN
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="reference-server.html"
ACCESSKEY="U"
>&#19978;&#19968;&#32423;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><SPAN
CLASS="APPLICATION"
>pg_resetxlog</SPAN
></TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
