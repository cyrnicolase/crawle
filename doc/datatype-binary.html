<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>二进制数据类型</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.6.0 手册"
HREF="index.html"><LINK
REL="UP"
TITLE="数据类型"
HREF="datatype.html"><LINK
REL="PREVIOUS"
TITLE="字符类型"
HREF="datatype-character.html"><LINK
REL="NEXT"
TITLE="日期/时间类型"
HREF="datatype-datetime.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2017-12-17T04:56:33"></HEAD
><BODY
CLASS="SECT1"
>
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/9.6/postgresql/doc/src/sgml/datatype.sgml" target="_blank" 
title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.6.0 手册</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="字符类型"
HREF="datatype-character.html"
ACCESSKEY="P"
>&#19978;&#19968;&#39029;</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="datatype.html"
ACCESSKEY="U"
>&#19978;&#19968;&#32423;</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>&#31456; 8. 数据类型</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="日期/时间类型"
HREF="datatype-datetime.html"
ACCESSKEY="N"
>&#19979;&#19968;&#39029;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="DATATYPE-BINARY"
>8.4. 二进制数据类型</A
></H1
><P
>    <TT
CLASS="TYPE"
>bytea</TT
>数据类型允许存储二进制串，参见<A
HREF="datatype-binary.html#DATATYPE-BINARY-TABLE"
>&#34920; 8-6</A
>。
   </P
><DIV
CLASS="TABLE"
><A
NAME="DATATYPE-BINARY-TABLE"
></A
><P
><B
>&#34920; 8-6. 二进制数据类型</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
>名字</TH
><TH
>存储尺寸</TH
><TH
>描述</TH
></TR
></THEAD
><TBODY
><TR
><TD
><TT
CLASS="TYPE"
>bytea</TT
></TD
><TD
>1或4字节外加真正的二进制串</TD
><TD
>变长二进制串</TD
></TR
></TBODY
></TABLE
></DIV
><P
>    二进制串是一个八位位组（或字节）的序列。 二进制串和字符串的区别有两个： 首先，二进制串明确允许存储零值的字节以及其它<SPAN
CLASS="QUOTE"
>"不可打印的"</SPAN
>字节（通常是位于范围 32 到 126 之外的字节）。 字符串不允许零字节，并且也不允许那些对于数据库的选定字符集编码是非法的任何其它字节值或者字节值序列。 第二，对二进制串的操作会处理实际上的字节，而字符串的处理和取决于区域设置。 简单说，二进制字串适用于存储那些程序员认为是<SPAN
CLASS="QUOTE"
>"裸字节"</SPAN
>的数据，而字符串适合存储文本。
   </P
><P
>    <TT
CLASS="TYPE"
>bytea</TT
>类型支持两种用于输入和输出的外部格式：<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>的历史的<SPAN
CLASS="QUOTE"
>"逃逸"</SPAN
>格式和<SPAN
CLASS="QUOTE"
>"十六进制"</SPAN
>格式。在输入时这两种格式总是会被接受。输出格式则取决于配置参数<A
HREF="runtime-config-client.html#GUC-BYTEA-OUTPUT"
>bytea_output</A
>，其默认值为十六进制（注意十六进制格式是在<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 9.0中被引入的，早期的版本和某些工具无法理解它）。
   </P
><P
>    <ACRONYM
CLASS="ACRONYM"
>SQL</ACRONYM
>标准定义了一种不同的二进制串类型， 叫做<TT
CLASS="TYPE"
>BLOB</TT
>或者<TT
CLASS="TYPE"
>BINARY LARGE OBJECT</TT
>。其输入格式和<TT
CLASS="TYPE"
>bytea</TT
>不同，但是提供的函数和操作符大多一样。
   </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN5699"
>8.4.1. <TT
CLASS="TYPE"
>bytea</TT
>的十六进制格式</A
></H2
><P
>    <SPAN
CLASS="QUOTE"
>"十六进制"</SPAN
>格式将二进制数据编码为每个字节2个十六进制位，最高有效位在前。整个串以序列<TT
CLASS="LITERAL"
>\x</TT
>开头（用以和逃逸格式区分）。在某些情景中，开头的反斜线可能需要通过双写来逃逸，在相同的情况中逃逸格式必须要双写反斜线，下文描述了细节。十六进制位可以是大写也可以是小写，在位对之间可以有空白（但是在位对内部以及开头的<TT
CLASS="LITERAL"
>\x</TT
>序列中不能有空白）。十六进制格式和很多外部应用及协议相兼容，并且其转换速度要比逃逸格式更快，因此人们更愿意用它。
   </P
><P
>    例子：
</P><PRE
CLASS="PROGRAMLISTING"
>SELECT E'\\xDEADBEEF';</PRE
><P>
   </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN5708"
>8.4.2. <TT
CLASS="TYPE"
>bytea</TT
>的逃逸格式</A
></H2
><P
>    <SPAN
CLASS="QUOTE"
>"逃逸"</SPAN
>格式是<TT
CLASS="TYPE"
>bytea</TT
>类型的传统<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>格式。它采用将二进制串表示成ASCII字符序列的方法，而将那些无法用ASCII字符表示的字节转换成特殊的逃逸语句。从应用的角度来看，如果将字节表示为字符有意义，那么这种表示将很方便。但是在实际中，这常常是令人困扰的，因为它使二进制串和字符串之间的区别变得模糊，并且这种特别的逃逸机制也有点难于处理。因此这种格式可能会在大部分新应用中避免使用。
   </P
><P
>    在逃逸模式下输入<TT
CLASS="TYPE"
>bytea</TT
>值时，某些值的字节<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>必须</I
></SPAN
>被逃逸，而所有的字节值都<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>可以</I
></SPAN
>被逃逸。通常，要逃逸一个字节，需要把它转换成与它的三位八进制值， 并且前导一个反斜线（或者两个反斜线，如果使用逃逸串语法将值写成一个字面含义）。反斜线本身（字节值92）也可以用双写的反斜线表示。<A
HREF="datatype-binary.html#DATATYPE-BINARY-SQLESC"
>&#34920; 8-7</A
>显示了必须被逃逸的字符，并给出了可以使用的替代逃逸序列。
   </P
><DIV
CLASS="TABLE"
><A
NAME="DATATYPE-BINARY-SQLESC"
></A
><P
><B
>&#34920; 8-7. <TT
CLASS="TYPE"
>bytea</TT
>文字逃逸字节</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><COL><THEAD
><TR
><TH
>十进制字节值</TH
><TH
>描述</TH
><TH
>逃逸输入表示</TH
><TH
>例子</TH
><TH
>输出表示</TH
></TR
></THEAD
><TBODY
><TR
><TD
>0</TD
><TD
>0字节</TD
><TD
><TT
CLASS="LITERAL"
>E'\\000'</TT
></TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\\000'::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>\000</TT
></TD
></TR
><TR
><TD
>39</TD
><TD
>单引号</TD
><TD
><TT
CLASS="LITERAL"
>''''</TT
>或<TT
CLASS="LITERAL"
>E'\\047'</TT
></TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\''::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>'</TT
></TD
></TR
><TR
><TD
>92</TD
><TD
>反斜线</TD
><TD
><TT
CLASS="LITERAL"
>E'\\\\'</TT
>或<TT
CLASS="LITERAL"
>E'\\134'</TT
></TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\\\\'::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>\\</TT
></TD
></TR
><TR
><TD
>0到31和127到255</TD
><TD
><SPAN
CLASS="QUOTE"
>"不可打印的"</SPAN
>字节</TD
><TD
><TT
CLASS="LITERAL"
>E'\\<TT
CLASS="REPLACEABLE"
><I
>xxx'</I
></TT
></TT
>（八进制值）</TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\\001'::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>\001</TT
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>    逃逸<SPAN
CLASS="QUOTE"
>"不可打印的"</SPAN
>字节的要求取决于区域设置。在某些实例中，你可以不理睬它们，让它们保持未逃逸的状态。注意在<A
HREF="datatype-binary.html#DATATYPE-BINARY-SQLESC"
>&#34920; 8-7</A
>的每一个例子中的结果的长度正好是一个字节，即使其输出表示有时超过一个字符。
   </P
><P
>    如<A
HREF="datatype-binary.html#DATATYPE-BINARY-SQLESC"
>&#34920; 8-7</A
>中所示，要求多个反斜线的原因是写成一个串文字的输入串在<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>服务器中必须经过两个分析阶段。每一对中的第一个反斜线被串文字分析器（假设使用了逃逸串语法）解释为一个逃逸字符并且因此被消耗，只留下该对中的第二个反斜线（美元符号包围的串可以被用于防止这一层的逃逸）。剩下的反斜线接着被<TT
CLASS="TYPE"
>bytea</TT
>输入函数识别为开始一个三位八进制值或逃逸另一个反斜线。例如，一个传递给服务器的串文字是<TT
CLASS="LITERAL"
>E'\\001'</TT
>，它在通过逃逸串分析器后变成<TT
CLASS="LITERAL"
>\001</TT
>。<TT
CLASS="LITERAL"
>\001</TT
>接着被送给<TT
CLASS="TYPE"
>bytea</TT
>输入函数，这里它被转换成一个十进制值为1的单字节。注意单引号字符串不会被<TT
CLASS="TYPE"
>bytea</TT
>特殊对待，因此它遵循串文字的正常规则（参见<A
HREF="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS"
>第 4.1.2.1 &#33410;</A
>）。
   </P
><P
>    <TT
CLASS="TYPE"
>Bytea</TT
>字节有时在输出时被逃逸。通常，每一个<SPAN
CLASS="QUOTE"
>"不可打印的"</SPAN
>字节会被转换成与之等效的三位八进制值并且前置一个反斜线。大部分<SPAN
CLASS="QUOTE"
>"可打印的"</SPAN
>字节被表示为它们在客户端字符集中的标准表示形式。十进制值为92（反斜线）的字节在输出时被双写。详情请见<A
HREF="datatype-binary.html#DATATYPE-BINARY-RESESC"
>&#34920; 8-8</A
>。
   </P
><DIV
CLASS="TABLE"
><A
NAME="DATATYPE-BINARY-RESESC"
></A
><P
><B
>&#34920; 8-8. <TT
CLASS="TYPE"
>bytea</TT
>输出逃逸字节</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><COL><COL><THEAD
><TR
><TH
>十进制字节值</TH
><TH
>描述</TH
><TH
>逃逸的输出表示</TH
><TH
>例子</TH
><TH
>输出结果</TH
></TR
></THEAD
><TBODY
><TR
><TD
>92</TD
><TD
>反斜线</TD
><TD
><TT
CLASS="LITERAL"
>\\</TT
></TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\\134'::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>\\</TT
></TD
></TR
><TR
><TD
>0到31和127到255</TD
><TD
><SPAN
CLASS="QUOTE"
>"不可打印的"</SPAN
>字节</TD
><TD
><TT
CLASS="LITERAL"
>\<TT
CLASS="REPLACEABLE"
><I
>xxx</I
></TT
></TT
>（八进制值）</TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\\001'::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>\001</TT
></TD
></TR
><TR
><TD
>32到126</TD
><TD
><SPAN
CLASS="QUOTE"
>"可打印的"</SPAN
>字节</TD
><TD
>客户端字符集表示</TD
><TD
><TT
CLASS="LITERAL"
>SELECT E'\\176'::bytea;</TT
></TD
><TD
><TT
CLASS="LITERAL"
>~</TT
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>    根据你使用的<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>前端，你在逃逸和未逃逸<TT
CLASS="TYPE"
>bytea</TT
>串方面可能需要做额外的工作。例如，如果你的接口自动翻译换行和回车，你可能也不得不逃逸它们。
   </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="datatype-character.html"
ACCESSKEY="P"
>&#19978;&#19968;&#39029;</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>&#36215;&#22987;&#39029;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="datatype-datetime.html"
ACCESSKEY="N"
>&#19979;&#19968;&#39029;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>字符类型</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="datatype.html"
ACCESSKEY="U"
>&#19978;&#19968;&#32423;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>日期/时间类型</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
