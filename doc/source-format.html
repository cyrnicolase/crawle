<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>格式化</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.6.0 手册"
HREF="index.html"><LINK
REL="UP"
TITLE="PostgreSQL编码习惯"
HREF="source.html"><LINK
REL="PREVIOUS"
TITLE="PostgreSQL编码习惯"
HREF="source.html"><LINK
REL="NEXT"
TITLE="在服务器中报告错误"
HREF="error-message-reporting.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2017-12-17T04:56:33"></HEAD
><BODY
CLASS="SECT1"
>
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/9.6/postgresql/doc/src/sgml/sources.sgml" target="_blank" 
title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.6.0 手册</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="PostgreSQL编码习惯"
HREF="source.html"
ACCESSKEY="P"
>&#19978;&#19968;&#39029;</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="source.html"
ACCESSKEY="U"
>&#19978;&#19968;&#32423;</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>&#31456; 52. PostgreSQL编码习惯</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="在服务器中报告错误"
HREF="error-message-reporting.html"
ACCESSKEY="N"
>&#19979;&#19968;&#39029;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SOURCE-FORMAT"
>52.1. 格式化</A
></H1
><P
>    源代码格式化使用 4 列制表间隔，并且保留制表符（即制表符不会被扩展成空格）。每一个逻辑缩进层就是一个额外的制表位。
   </P
><P
>    布局规则（括号定位等）遵循 BSD 习惯。特别地，<TT
CLASS="LITERAL"
>if</TT
>、<TT
CLASS="LITERAL"
>while</TT
>、<TT
CLASS="LITERAL"
>switch</TT
>等受控块的花括号要独自占据一行。
   </P
><P
>    限制行长度，这样在 80 列窗口中代码也是可读的（这并不意味着你不能超过 80 列。例如，为了保持代码在 80 列以内而在任意位置打断一段长的错误消息字符串可能不会给可读性带来什么好处）。
   </P
><P
>    不使用 C++ 风格的注释（<TT
CLASS="LITERAL"
>//</TT
>注释）。严格的 ANSI C 编译器不接受这样的注释。出于相同的原因，不使用 C++ 扩展，例如在块中声明新变量。
   </P
><P
>    多行注释块更好的风格是
</P><PRE
CLASS="PROGRAMLISTING"
>/*
 * 注释文本从这里开始
 * 延续到这里
 */</PRE
><P>
    注意从列 1 开始的注释块将被<SPAN
CLASS="APPLICATION"
>pgindent</SPAN
>原样保留，但是它将重新对缩进的注释块断行，好像它们是纯文本一样。如果你想要保留一个缩进块中的换行，可以像这样增加破折号：
</P><PRE
CLASS="PROGRAMLISTING"
>    /*----------
     * 注释文本从这里开始
     * 延续到这里
     *----------
     */</PRE
><P>
   </P
><P
>    虽然在提交补丁时并不是一定要遵守这些格式化规则，但是最好能遵守。在下一次发行前你提交的代码将会通过<SPAN
CLASS="APPLICATION"
>pgindent</SPAN
>，因此使用某种其他格式化习惯无法使代码被编排得很好。对于补丁，一种比较好的经验规则是<SPAN
CLASS="QUOTE"
>"让新代码看起来像它周围的原有代码"</SPAN
>。
   </P
><P
>    <TT
CLASS="FILENAME"
>src/tools</TT
>目录包含有可以用于<SPAN
CLASS="PRODUCTNAME"
>emacs</SPAN
>、<SPAN
CLASS="PRODUCTNAME"
>xemacs</SPAN
>或者<SPAN
CLASS="PRODUCTNAME"
>vim</SPAN
>编辑器的设置文件，它们可以帮助确保这些编辑器会根据上述习惯格式化代码。
   </P
><P
>    可以这样调用文本浏览工具<SPAN
CLASS="APPLICATION"
>more</SPAN
>和<SPAN
CLASS="APPLICATION"
>less</SPAN
>：
</P><PRE
CLASS="PROGRAMLISTING"
>more -x4
less -x4</PRE
><P>
    来让它们以合适的方式显示制表符。
   </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="source.html"
ACCESSKEY="P"
>&#19978;&#19968;&#39029;</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>&#36215;&#22987;&#39029;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="error-message-reporting.html"
ACCESSKEY="N"
>&#19979;&#19968;&#39029;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>PostgreSQL编码习惯</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="source.html"
ACCESSKEY="U"
>&#19978;&#19968;&#32423;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>在服务器中报告错误</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
